"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const DingConfig_1 = require("./DingConfig");
const jwt = require('jsonwebtoken');
/**
 * AuthService
 */
class AuthService {
    authUser(authorization) {
        let token = authorization.substr(7);
        //
        let auth = jwt.decode(token, DingConfig_1.default.noncestr);
        if (!auth) {
            throw '对不起，您无权限访问！';
        }
        return auth;
    }
    async isAdmin(ctx, next) {
        let token = ctx.header.authorization.substr(7);
        let user = jwt.decode(token, DingConfig_1.default.noncestr);
        if (!user) {
            throw '对不起，您无权限访问！';
        }
        if (user.is_sys) {
            await next();
        }
        else {
            throw '对不起，您无权限访问！';
        }
    }
}
exports.AuthService = AuthService;
const auth = new AuthService();
exports.default = auth;
